<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Login • CrowdSolve</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        body{font-family:Arial, sans-serif;background:#f6f7f9;padding:30px;}
        .card{max-width:360px;margin:50px auto;background:#fff;padding:25px;border-radius:12px;box-shadow:0 5px 20px rgba(0,0,0,0.1);}
        input,button{width:100%;padding:10px;margin:10px 0;border:1px solid #ddd;border-radius:8px;}
        button{background:#2563eb;color:#fff;border:none;cursor:pointer;}
        button:hover{opacity:.9;}
        .msg{margin-top:10px;font-size:14px;}
        a{color:#2563eb;text-decoration:none;}
    </style>
</head>
<body>
<div class="card">
    <h2>Login</h2>
    <form id="loginForm">
        <input type="email" id="email" placeholder="Email" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="submit">Login</button>
    </form>
    <p>Don’t have an account? <a href="/signup">Sign up</a></p>
    <div id="message" class="msg"></div>
</div>

<script>
    const $ = id => document.getElementById(id);
    $("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      $("message").textContent = "Logging in...";
      try {
        const res = await fetch("/auth/login", {
          method:"POST",
          headers:{"Content-Type":"application/json"},
          body: JSON.stringify({
            email: $("email").value.trim(),
            password: $("password").value
          })
        });
        if (!res.ok) throw new Error("Login failed");
        const data = await res.json();
        localStorage.setItem("token", data.token);
        localStorage.setItem("role", data.role);
        localStorage.setItem("userId", data.userId);
        $("message").style.color="green";
        $("message").textContent="Login successful!";
      } catch (err) {
        $("message").style.color="crimson";
        $("message").textContent="Invalid email or password.";
      }
    });
</script>
</body>
</html>
